# Docker Compose Cheat Sheet

# Docker Compose file version
version: '3.8'

# Define services
services:
  # Service name
  webapp:
    # Specify the image to use
    image: webapp:latest
    # Build from a Dockerfile
    build:
      context: ./dir
      dockerfile: Dockerfile
    # Define command to run
    command: python app.py
    # Set environment variables
    environment:
      - DEBUG=1
    # Mount volumes
    volumes:
      - ./data:/data
    # Publish ports
    ports:
      - "5000:5000"
    # Define network
    networks:
      - webnet
    # Define dependency on another service
    depends_on:
      - db

  db:
    image: postgres:latest
    environment:
      POSTGRES_PASSWORD: example
    # Define healthcheck
    healthcheck:
      test: ["CMD-SHELL", "pg_isready -U postgres"]
      interval: 10s
      timeout: 5s
      retries: 5
    volumes:
      - db-data:/var/lib/postgresql/data
    networks:
      - webnet

# Define networks
networks:
  webnet:

# Define volumes
volumes:
  db-data:

# Notes:
# - The version specifies the syntax and functionalities available in the Compose file.
# - Services are the different containers you want to run.
# - Images can be pulled from Docker Hub or built from a Dockerfile.
# - Environment variables can be set for configuration.
# - Volumes are used for persisting data generated by and used by Docker containers.
# - Ports are mapped from host to container.
# - Networks define how containers communicate with each other.
# - Dependencies can be set to control the order of service startup.
# - Healthcheck can be used to check the health of a service.

# For a comprehensive guide and additional options, refer to the Docker Compose documentation.
